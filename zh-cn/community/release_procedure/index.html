<!doctype html>
<html lang="zh-cn" dir="ltr" class="mdx-wrapper mdx-page plugin-pages plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">发布流程 | Apache YuniKorn</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://yunikorn.apache.org/zh-cn/img/logo/yunikorn-logo-main.png"><meta data-rh="true" name="twitter:image" content="https://yunikorn.apache.org/zh-cn/img/logo/yunikorn-logo-main.png"><meta data-rh="true" property="og:url" content="https://yunikorn.apache.org/zh-cn/community/release_procedure"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="发布流程 | Apache YuniKorn"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/zh-cn/img/yunikorn.ico"><link data-rh="true" rel="canonical" href="https://yunikorn.apache.org/zh-cn/community/release_procedure"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/community/release_procedure" hreflang="en"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/zh-cn/community/release_procedure" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://yunikorn.apache.org/community/release_procedure" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Q1V951BG2V-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Apache YuniKorn" href="/zh-cn/opensearch.xml"><link rel="stylesheet" href="/zh-cn/assets/css/styles.1e6e3144.css">
<link rel="preload" href="/zh-cn/assets/js/runtime~main.bdaf632d.js" as="script">
<link rel="preload" href="/zh-cn/assets/js/main.f4f57a7e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">1.1.0 has been released, check the DOWNLOADS</div><button type="button" aria-label="关闭" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-cn/"><div class="navbar__logo"><img src="/zh-cn/img/logo/yunikorn_blue_logo.png" alt="YuniKorn Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh-cn/img/logo/yunikorn_white_logo.png" alt="YuniKorn Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Apache YuniKorn</b></a><a class="navbar__item navbar__link" href="/zh-cn/docs/">快速开始</a><a class="navbar__item navbar__link" href="/zh-cn/community/roadmap">路线图</a><a class="navbar__item navbar__link" href="/zh-cn/community/download">下载</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">社区</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-cn/community/get_involved">进行参与</a></li><li><a class="dropdown__link" href="/zh-cn/community/how_to_contribute">如何贡献</a></li><li><a class="dropdown__link" href="/zh-cn/community/coding_guidelines">编码指南</a></li><li><a class="dropdown__link" href="/zh-cn/community/reporting_issues">报告问题</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh-cn/community/release_procedure">发布流程</a></li><li><a class="dropdown__link" href="/zh-cn/community/events">事件</a></li><li><a class="dropdown__link" href="/zh-cn/community/people">人员</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Apache软件基金会<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">事件<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">赞助商<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">赞助<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy Policy<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/zh-cn/docs">文档</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-cn/docs/next/">Master</a></li><li><a class="dropdown__link" href="/zh-cn/docs/">1.1.0</a></li><li><a class="dropdown__link" href="/zh-cn/docs/1.0.0/">1.0.0</a></li><li><a class="dropdown__link" href="/zh-cn/docs/0.12.2/">0.12.2</a></li><li><a class="dropdown__link" href="/zh-cn/docs/0.12.1/">0.12.1</a></li><li><a class="dropdown__link" href="/zh-cn/docs/0.11.0/">0.11.0</a></li><li><a class="dropdown__link" href="/zh-cn/docs/0.10.0/">0.10.0</a></li><li><a class="dropdown__link" href="/zh-cn/docs/0.9.0/">0.9.0</a></li><li><a class="dropdown__link" href="/zh-cn/docs/0.8.0/">0.8.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/community/release_procedure" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-cn/community/release_procedure" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-cn">中文</a></li></ul></div><a href="https://github.com/apache/yunikorn-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><main class="container container--fluid margin-vert--lg"><div class="row mdxPageWrapper_j9I6"><div class="col col--8"><article><h1>YuniKorn 发布流程</h1><p><a href="https://github.com/apache/yunikorn-release" target="_blank" rel="noopener noreferrer">发布存储库</a> 包含了 Apache YuniKorn 创建发行版本/发布（为了区分一些释义以及词语概念的混淆，下文暂在一些描述中以原始名称 release 进行说明）的代码和配置。
我们需要在开始发布流程之前克隆存储库并签出主分支。
即使之前已经发布过该版本，也请确保签出最新的发布内容，因为代码和/或配置可能已更改。</p><p>相关说明和工具会遵守ASF的<a href="http://www.apache.org/legal/release-policy.html" target="_blank" rel="noopener noreferrer">发布政策</a>。</p><ul><li><a href="#%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B">发布流程</a></li><li><a href="#%E6%B5%81%E7%A8%8B%E6%AD%A5%E9%AA%A4">流程步骤</a><ul><li><a href="#%E6%89%93%E6%A0%87%E7%AD%BE%E5%B9%B6%E6%9B%B4%E6%96%B0%E5%8F%91%E5%B8%83%E7%89%88%E6%9C%AC">打标签并更新发布版本</a></li><li><a href="#%E6%9B%B4%E6%96%B0%E4%BF%AE%E6%94%B9%E6%97%A5%E5%BF%97">更新修改日志</a></li><li><a href="#%E8%BF%90%E8%A1%8C%E5%8F%91%E5%B8%83%E5%B7%A5%E5%85%B7">运行发布工具</a><ul><li><a href="#%E5%88%9B%E5%BB%BA%E7%AD%BE%E5%90%8D">创建签名</a></li><li><a href="#%E5%88%9B%E5%BB%BAchecksum">创建Checksum</a></li></ul></li><li><a href="#%E4%B8%8A%E4%BC%A0%E5%80%99%E9%80%89%E5%8F%91%E5%B8%83%E6%96%87%E4%BB%B6">上传候选发布文件</a></li><li><a href="#%E5%BC%80%E5%A7%8B%E6%8A%95%E7%A5%A8%E6%B5%81%E7%A8%8B">开始投票流程</a></li><li><a href="#%E5%8F%91%E5%B8%83">发布</a><ul><li><a href="#%E5%8F%91%E5%B8%83-docker-%E9%95%9C%E5%83%8F">发布 Docker 镜像</a></li><li><a href="#%E5%8F%91%E5%B8%83-helm-charts">发布 Helm Charts</a></li><li><a href="#%E6%9B%B4%E6%96%B0%E7%BD%91%E7%AB%99">更新网站</a></li><li><a href="#%E6%B8%85%E7%90%86">清理</a></li><li><a href="#%E5%88%9B%E5%BB%BA-git-%E5%8F%91%E5%B8%83">创建 GIT 发布</a></li></ul></li><li><a href="#%E9%AA%8C%E8%AF%81%E5%8F%91%E5%B8%83">验证发布</a></li></ul></li><li><a href="#%E4%B8%BA%E6%96%B0%E5%8F%91%E5%B8%83%E6%9B%B4%E6%96%B0%E7%BD%91%E7%AB%99">为新发布更新网站</a><ul><li><a href="#%E6%9B%B4%E6%96%B0%E6%96%87%E6%A1%A3%E7%89%88%E6%9C%AC">更新文档版本</a></li><li><a href="#%E5%8F%91%E5%B8%83%E5%85%AC%E5%91%8A">发布公告</a></li><li><a href="#%E6%9B%B4%E6%96%B0%E4%B8%8B%E8%BD%BD%E9%A1%B5%E9%9D%A2">更新下载页面</a></li></ul></li><li><a href="#%E7%AD%BE%E5%90%8D%E6%82%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%91%E5%B8%83">签名您的第一个发布</a><ul><li><a href="#%E7%94%9F%E6%88%90%E5%AF%86%E9%92%A5">生成密钥</a></li><li><a href="#%E5%B0%86%E7%AD%BE%E5%90%8D%E6%B7%BB%E5%8A%A0%E5%88%B0%E9%A1%B9%E7%9B%AEkeys%E6%96%87%E4%BB%B6%E4%B8%AD">将签名添加到项目KEYS文件中</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="发布流程">发布流程<a class="hash-link" href="#发布流程" title="标题的直接链接">​</a></h2><p>简化的发布流程：</p><ol><li>在所有 git 存储库中为目标 release 的版本创建一个发布分支，比如 <code>branch-0.8</code></li><li>这个发布版本只能通过修复测试失败问题和错误来趋于稳定</li><li>给新版本的更新发布打标签，以作为准备发布的候选版本，例如给 RC1 标记为 <code>v0.8.0-1</code> </li><li>更新 CHANGELOG (以后统称为修改日志)</li><li>配置<a href="https://github.com/apache/yunikorn-release/tree/master/tools/release-configs.json" target="_blank" rel="noopener noreferrer">release-configs.json</a></li><li>运行脚本<a href="https://github.com/apache/yunikorn-release/tree/master/tools/build-release.py" target="_blank" rel="noopener noreferrer">build-release.py</a> 生成源代码压缩包、checksum 和签名。</li><li>投票和发布候选版本</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="流程步骤">流程步骤<a class="hash-link" href="#流程步骤" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="打标签并更新发布版本">打标签并更新发布版本<a class="hash-link" href="#打标签并更新发布版本" title="标题的直接链接">​</a></h3><p>分支和标签可以——并且在大多数情况下会——更改 go mod 文件。
分支是发布准备阶段的一部分，通常在发布过程开始之前的某个时间发生。
一个 release 在开始发布流程之前，需要在 git 中给它打上标签。
可以查看 <a href="https://issues.apache.org/jira/browse/YUNIKORN-358" target="_blank" rel="noopener noreferrer">YUNIKORN-358</a> 或者 <a href="https://issues.apache.org/jira/browse/YUNIKORN-1004" target="_blank" rel="noopener noreferrer">YUNIKORN-1004</a>，他们可以作为例子进行参考。
release 的候选版号本应该用 release 的版本号和候选构建数进行标记。
例如，用于构建 0.8.0 RC2 的文件应该标记为 <code>v0.8.0-2</code>，并在 GitHub 中创建该 release。
一旦 release 完成，应该为 <code>v0.8.0</code> 创建 git 的标签和 GitHub 的 releases，指向相同的提交。
在任何情况下，都不应删除或移动现有的标签。这将打破下游用户的 golang 依赖解析。</p><p>标签处理是一个多步骤的过程，所有操作都需在将要发布的分支上完成，例如 <code>branch-0.8</code> ：</p><ol><li>给 web 和 scheduler-interface 项目打上发布标签。</li><li>使用 <code>go get github.com/apache/yunikorn-scheduler-interface</code> 更新 core 项目中的 <code>go.mod</code> 文件，然后添加标签并提交更改。</li><li>使用 <code>go get github.com/apache/yunikorn-scheduler-interface</code> 和 <code>go get github.com/apache/yunikorn-core</code> 更新 shim 项目中的 <code>go.mod</code> 文件。之后再添加标签并提交更改。</li><li>在yunikorn的发布存储库中新建一个分支，然后在<a href="https://github.com/apache/yunikorn-release/tree/master/helm-charts/yunikorn/Chart.yaml" target="_blank" rel="noopener noreferrer">Chart.yaml</a> 中设置正确的chart版本并创建标签。</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="更新修改日志">更新修改日志<a class="hash-link" href="#更新修改日志" title="标题的直接链接">​</a></h3><p>我们为每次 release 内的发布文件里添加了一个<a href="https://github.com/apache/yunikorn-release/tree/master/release-top-level-artifacts/CHANGELOG" target="_blank" rel="noopener noreferrer">修改日志</a>。
修改日志应包含版本中修复的 jiras 列表。
我们可以按照以下步骤生成列表：</p><ul><li>转到 <a href="https://issues.apache.org/jira/projects/YUNIKORN?selectedItem=com.atlassian.jira.jira-projects-plugin%3Arelease-page&amp;status=released-unreleased" target="_blank" rel="noopener noreferrer">jira发布页面</a></li><li>点击即将发布的版本，例如 <code>0.8.0</code></li><li>点击页面顶部的 <code>Release Notes</code>（发布说明） 链接</li><li>单击 <code>Configure Release Notes</code>（配置发布说明）按钮</li><li>选择样式 <code>Text</code> 并点击 <code>create</code></li><li>滚动到页面底部并复制文本区域的内容并更新 ../release-top-level-artifacts 目录中的修改日志文件。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="运行发布工具">运行发布工具<a class="hash-link" href="#运行发布工具" title="标题的直接链接">​</a></h3><p>我们已经编写了一个工具来处理大部分的发布任务。
该工具需要在运行前更新一个简单的 <a href="https://github.com/apache/yunikorn-release/tree/master/tools/release-configs.json" target="_blank" rel="noopener noreferrer">json</a> 输入文件。
此配置指向当前的发布标签。它只会更新每个存储库的标签。</p><p>该工具在标准的Python3之外有一项要求：<a href="https://gitpython.readthedocs.io/en/stable/intro.html" target="_blank" rel="noopener noreferrer">GitPython</a>。
请确保您已通过运行 <code>pip install gitpython</code> 来安装它。</p><p>运行工具:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">python3 build-release.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果您想使用 GPG 密钥自动签署版本，请使用以下命令运行该工具：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">python3 build-release.py --sign </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">邮件地址</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="创建签名">创建签名<a class="hash-link" href="#创建签名" title="标题的直接链接">​</a></h4><p>如果您有带有 <em>pinentry</em> 程序设置的 GPG，您可以使用发布工具自动签署发布。
在 MacOSX 上，如果您使用钥匙串作为秘钥，这将自动设置。
有关更多的详情，请查看 <a href="https://wiki.archlinux.org/index.php/GnuPG" target="_blank" rel="noopener noreferrer">GnuPG 工具 wiki</a>，特别是 <a href="https://wiki.archlinux.org/index.php/GnuPG#pinentry" target="_blank" rel="noopener noreferrer">pinentry</a> 章节。</p><p>使用 <code>--sign &lt;邮件地址&gt;</code> 选项来运行发布工具以自动签署发布。</p><p>为工具生成的文件手动创建签名：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpg --local-user </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">邮件地址</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> --armor --output apache-yunikorn-0.8.0-src.tar.gz.asc --detach-sig apache-yunikorn-0.8.0-src.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这将在文件中创建签名：<code>apache-yunikorn-0.8.0-src.tar.gz.asc</code><br>
<!-- -->使用以下命令验证签名是否正确：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpg --verify apache-yunikorn-0.8.0-src.tar.gz.asc apache-yunikorn-0.8.0-src.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="创建checksum">创建Checksum<a class="hash-link" href="#创建checksum" title="标题的直接链接">​</a></h4><p>这一步包含在源tar包生成后的发布内容中，如果使用发布工具可以跳过这一步。</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">shasum -a </span><span class="token number" style="color:rgb(247, 140, 108)">512</span><span class="token plain"> apache-yunikorn-0.8.0-src.tar.gz </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> apache-yunikorn-0.8.0-src.tar.gz.sha512</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这将在文件中创建 checksum : <code>apache-yunikorn-0.8.0-src.tar.gz.sha512</code><br>
<!-- -->使用以下命令验证 checksum 是否正确：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">shasum -a </span><span class="token number" style="color:rgb(247, 140, 108)">512</span><span class="token plain"> -c apache-yunikorn-0.8.0-src.tar.gz.sha512 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="上传候选发布文件">上传候选发布文件<a class="hash-link" href="#上传候选发布文件" title="标题的直接链接">​</a></h3><p>发布的文件由三个部分组成：</p><ul><li>源压缩包</li><li>签名文件</li><li>checksum文件  </li></ul><p>三个文件都需要上传到：<code>https://dist.apache.org/repos/dist/dev/yunikorn/</code></p><p>根据版本创建发布目录，例如 <code>0.8.0</code>，将这三个文件添加到目录中，随后提交更改。</p><p>如果您还没有这样做，请确保 <a href="#%E5%B0%86%E7%AD%BE%E5%90%8D%E6%B7%BB%E5%8A%A0%E5%88%B0%E9%A1%B9%E7%9B%AEkeys%E6%96%87%E4%BB%B6%E4%B8%AD">添加您的签名</a> 到 KEYS 文件。
不要从保存在此处的文件中删除任何密钥，这是为了方便验证旧的版本。</p><p>注意：您需要安装 subversion 才能访问此 repo（使用您的 apache ID）。为方便起见，您可以使用任何 SVN 客户端，例如 svnX。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="开始投票流程">开始投票流程<a class="hash-link" href="#开始投票流程" title="标题的直接链接">​</a></h3><p>根据 Apache <a href="http://www.apache.org/legal/release-policy.html#release-approval" target="_blank" rel="noopener noreferrer">发布批准文档</a>
投票流程必须在 <code>dev@yunikorn.apache.org</code> 上创建，并运行至少72小时。
需要至少三个 +1 票，而且 +1 票要多于 -1 票。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="发布">发布<a class="hash-link" href="#发布" title="标题的直接链接">​</a></h3><p>一旦投票通过，将发布的文件从暂存区移动到发布位置 <code>https://dist.apache.org/repos/dist/release/yunikorn/</code>。<br>
<!-- -->一旦移动到这个空间，内容将自动同步到 <code>https://downloads.apache.org/yunikorn/</code>，它必须作为所有发布文件的最终位置。  </p><p>可以阅读 <a href="https://apache.org/history/mirror-history.html" target="_blank" rel="noopener noreferrer">分布式服务</a> 来了解更多有关源代码的内容。</p><p>这将会在发布区暂时为我们提供两个版本。
这是允许启动镜像同步过程并允许更新下载页面的必要条件。
在 <a href="#%E6%B8%85%E7%90%86">清理</a> 章节中会说明如何在更新网站后对旧的版本进行清理。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="发布-docker-镜像">发布 Docker 镜像<a class="hash-link" href="#发布-docker-镜像" title="标题的直接链接">​</a></h4><p>我们应该使用标准构建过程来构建镜像。
在 <code>web</code> 和 <code>k8shim</code> 存储库中运行 <code>make image</code> 以生成所需的三个镜像（web、调度器和准入控制器）：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.8</span><span class="token plain">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> image</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果您有权访问 Apache docker hub YuniKorn 容器，Make 也可用于构建和推送映像。
使用发布版本号作为标签将最新的 docker 镜像推送到 apache docker hub。
需要确保 docker 映像是基于特定的 SHA 构建的。</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.8</span><span class="token plain">.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">DOCKER_USERNAME</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">用户名</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">DOCKER_PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">密码</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> push </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>最后向 <code>dev@yunikorn.apache.org</code> 邮件列表发布一个公告邮件。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="发布-helm-charts">发布 Helm Charts<a class="hash-link" href="#发布-helm-charts" title="标题的直接链接">​</a></h4><p>此步骤是发布工具的一部分，如果使用了发布工具则可以跳过这个打包步骤。</p><p>如果发布工具 <strong>未</strong> 使用 <code>Chart.yaml</code>， 那么 <code>values.yaml</code> 必须手动更新。
另一种选择是像发布工具一样针对生成的源目录运行 helm 脚本：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm package --sign --key </span><span class="token variable" style="color:rgb(191, 199, 213)">${您的key名称}</span><span class="token plain"> --keyring </span><span class="token variable" style="color:rgb(191, 199, 213)">${path</span><span class="token variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token variable" style="color:rgb(191, 199, 213)">to</span><span class="token variable operator" style="color:rgb(137, 221, 255)">/</span><span class="token variable" style="color:rgb(191, 199, 213)">keyring.secret}</span><span class="token plain"> staging/</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">发布文件夹</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">/helm-charts/yunikorn --destination staging/ </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>签署 helm 包需要一个旧的 PGP keyring。 PGP v2 keyring 必须转换为旧的格式。
想了解更多的信息，请查看 <a href="https://helm.sh/docs/topics/provenance/" target="_blank" rel="noopener noreferrer">Helm 文档</a>。
Helm charts 应在发布时签名。
与源代码 tar 包签名相反，对 helm 图表进行签名需要手动输入密钥密码。</p><p>helm 打包会生成两个文件：</p><ul><li>helm 打包文件：例如 <code>yunikorn-0.8.0.tgz</code></li><li>出处或签名文件：例如 <code>yunikorn-0.8.0.tgz.prov</code>
这两个文件都应附加到发布存储库的 <a href="#%E5%88%9B%E5%BB%BAGIT%E5%8F%91%E5%B8%83">创建GIT发布</a> 中。</li></ul><p>最后一步是使用新的发布版本更新 <code>gh-pages</code> 分支中的 <a href="https://github.com/apache/yunikorn-release/blob/gh-pages/index.yaml" target="_blank" rel="noopener noreferrer">index.yaml</a> 文件。
index.yaml 文件中提到的 <code>摘要</code> 是由工具（未签名的包）打印或存储在出处文件中的摘要。
我们可以使用以下方法手动生成：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">shasum -a </span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token plain"> yunikorn-0.8.0.tgz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意：不要使用 <code>helm repo index</code> 命令来更新 <code>index.yaml</code> 文件。该命令不能很好地处理存储在 <code>index.yaml</code> 文件中的增强信息。
请手动更新文件。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="更新网站">更新网站<a class="hash-link" href="#更新网站" title="标题的直接链接">​</a></h4><ul><li>根据 <code>docs</code> 目录中的最新内容，在 YuniKorn 网站上创建一个新的文档版本。
请参考<a href="#%E6%9B%B4%E6%96%B0%E6%96%87%E6%A1%A3%E7%89%88%E6%9C%AC">如下步骤</a>来了解如何创建新的文档版本。</li><li>从网站上的下载页面下创建发布公告的引用链接。
发布公告是一个基于版本号的 markdown 文件: <code>0.8.0.md</code>。
如何创建<a href="#%E5%8F%91%E5%B8%83%E5%85%AC%E5%91%8A">发布公告</a>的章节解释了相关的内容以及添加文件的位置。</li><li>按照<a href="#%E6%9B%B4%E6%96%B0%E4%B8%8B%E8%BD%BD%E9%A1%B5%E9%9D%A2">此步骤</a>更新网站的<a href="/zh-cn/community/download">下载页面</a>。</li></ul><p>这个网站可以，而且很可能会包含一个公告栏。
这个公告栏是源代码树的根目录中 <code>docusaurus.config.js</code> 文件的一部分。
我们需要更新公告栏到正确的 release。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="清理">清理<a class="hash-link" href="#清理" title="标题的直接链接">​</a></h4><p>注意：此步骤应在网站更新后执行，因为下载链接会进行更改。</p><p>发布区域中应该只有一个发布信息，即最新的发布。
已在发布区域中的任何发布信息都将自动复制到存档中。
旧的发布信息应直接从存档下载，而不是从发布区域下载。</p><p>发布信息需要在两个位置进行清理：</p><ul><li>通过删除旧的候选发布目录，从 <em>dev</em> 区域中删除新发布的版本。
请参阅 <a href="#%E4%B8%8A%E4%BC%A0%E5%80%99%E9%80%89%E5%8F%91%E5%B8%83%E6%96%87%E4%BB%B6">候选发布位置</a> 来查看相关位置</li><li>通过删除旧发布目录从 <em>发布</em> 区域中删除非当前的发布信息。
请参见 <a href="#%E5%8F%91%E5%B8%83">发布位置</a> 来查看相关位置</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="创建-git-发布">创建 GIT 发布<a class="hash-link" href="#创建-git-发布" title="标题的直接链接">​</a></h4><p>在 GIT 存储库中，通过添加的 git 标签来创建发布，并最终完成发布流程。
对所有五个存储库（core、k8shim、web、scheduler-interface 和 release）都重复这些步骤：</p><ul><li>转到 <code>tags</code> 页面</li><li>单击要发布的页面右侧的 <code>...</code> ，从下拉列表中选择 <code>Create Release</code></li><li>更新名称和说明</li><li>添加打包好的 helm chart 文件（仅限 yunikorn-release 存储库）</li><li>单击 <code>Publish Release</code> 以完成步骤</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="验证发布">验证发布<a class="hash-link" href="#验证发布" title="标题的直接链接">​</a></h3><p>在整个流程完成后，我们需要验证网站上的文档。
检查发布的文件是否可以从下载页面进行下载。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="为新发布更新网站">为新发布更新网站<a class="hash-link" href="#为新发布更新网站" title="标题的直接链接">​</a></h2><p>发布新版本需要您在本地安装 yarn。</p><p>先决条件：</p><ul><li>该 release 必须已从发布流程获得批准。</li><li>源存档文件和签名必须已上传到 Apache 对应的位置。</li><li>docker 公共镜像必须已推送到 Apache docker hub。</li></ul><p>打开一个PR，并将下面的所有更改提交到 <strong>master</strong> 分支，一旦自动构建完成，新的文档就会出现在网站上。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="更新文档版本">更新文档版本<a class="hash-link" href="#更新文档版本" title="标题的直接链接">​</a></h3><p>文档的版本控制使用简单的 <strong>主要版本.次要版本.补丁版本</strong> 这种 semver（语义化的版本号）形式定义发布版本号。
这意味着没有字母，候选发布标签或类似的东西:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">yarn</span><span class="token plain"> release </span><span class="token number" style="color:rgb(247, 140, 108)">0.8</span><span class="token plain">.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>该命令将对当前 <code>docs</code> 目录中的所有文档打快照，并将所有文件复制到另一个新目录 <code>versioned_docs</code> 下，例如 <code>versioned_docs/version-0.8.0</code> 。
类似的复制过程会在 <code>versioned_sidebars</code> 下生成对应文档版本的侧边栏。</p><p>这个过程还会更新 <code>version.json</code> 文件，并将添加一行新的发布版本。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="发布公告">发布公告<a class="hash-link" href="#发布公告" title="标题的直接链接">​</a></h3><p>发布公告是一个添加到 <code>src/pages/release-announce</code> 目录下的静态 Markdown 文件。
文件名与发布的 semver 简化版本号相同:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">src/pages/release-announce/0.8.0.md</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>该页面采用 Markdown 格式，应遵循现有页面的示例：</p><ul><li>id和标题定义（docusaurus 语法）</li><li>Apache license</li><li>如下的标题<ul><li>发布的概述（2级标题）</li><li>重点内容（2级标题）<br>在第3级标题说明各个重点</li><li>社区更新（2级标题）</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="更新下载页面">更新下载页面<a class="hash-link" href="#更新下载页面" title="标题的直接链接">​</a></h3><p>下载页面要包含指定到 Apache 源代码下载、签名等的链接。
页面上的表格有一个特定的布局，在完成 docusaurus 构建后，该布局会被正确地呈现。
请不要更改表格中的发布条目的布局。</p><p>第一步是将 <code>最新版本</code> 行更新为正确的版本。
第二步是更新表：从表中删除最后一行。
复制表格的第一行并更改链接和详细信息以反映新的发布详情。
必须更新所有的链接：</p><ul><li>3个用于下载的内容（源码tar、checksum 和签名）</li><li>3个用于docker的镜像（scheduler, admission-controller 和 web）</li><li>1个发布公告，使用 <code>/release-announce/0.8.0</code> 形式的链接</li></ul><p>对于第二行，更新源码tar、checksum 和签名的下载链接。</p><p>发布的链接必须遵循以下规则：</p><ul><li>页面上的第一个下载链接 <strong>必须</strong> 只能使用源码tar包的镜像解析链接。</li><li>签名和 checksum 链接 <strong>必须</strong> 指向发布地址。</li><li>非当前版本 <strong>必须</strong> 使用存档链接：<code>https://archive.apache.org/dist/yunikorn/</code> 用于 tar 包、签名和checksum。</li></ul><p>表中应保留有限的三或四个版本以供直接访问。
表中未提及的旧版本仍可通过页面底部的存档链接访问，无需参考。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="签名您的第一个发布">签名您的第一个发布<a class="hash-link" href="#签名您的第一个发布" title="标题的直接链接">​</a></h2><p>如果您之前没有对任何版本进行签名，请阅读文档以 <a href="https://infra.apache.org/openpgp.html#generate-key" target="_blank" rel="noopener noreferrer">生成签名密钥</a>
请按照以下步骤添加可用于签名的密钥。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成密钥">生成密钥<a class="hash-link" href="#生成密钥" title="标题的直接链接">​</a></h3><p>生成新的 PGP 密钥（如果您已有 Apache 链接密钥，请跳过此步骤）：</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpg --gen-key</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用您的全名和 Apache 邮件地址填写请求的信息。</p><p>将导出的密钥上传到像 <code>https://pgp.mit.edu/</code> 这样的公钥服务器。</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpg --export --armor </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">邮件地址</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将 fingerprint 上传到 apache 服务器：<code>https://id.apache.org/</code>。</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gpg --fingerprint </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">邮件地址</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="将签名添加到项目keys文件中">将签名添加到项目KEYS文件中<a class="hash-link" href="#将签名添加到项目keys文件中" title="标题的直接链接">​</a></h3><p>只有当这是使用特定密钥签名的第一个发布版本时才需要。
可以在此文档中找到更多详细信息：<a href="https://infra.apache.org/release-signing.html#keys-policy" target="_blank" rel="noopener noreferrer">签署版本</a></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gpg --list-sigs </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">邮件地址</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> gpg --armor --export </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">邮件地址</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;&gt;</span><span class="token plain"> MY_KEY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>将生成文件的内容添加到 <code>https://dist.apache.org/repos/dist/release/yunikorn/KEYS</code> 现有 KEYS 列表中。<br>
<!-- -->切勿从此列表中删除密钥！</p><p>注意：您需要安装 subversion 才能访问此 repo（使用您的 apache ID）。为方便起见，您可以使用任何 SVN 客户端，例如 svnX。</p></article></div><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#发布流程" class="table-of-contents__link toc-highlight">发布流程</a></li><li><a href="#流程步骤" class="table-of-contents__link toc-highlight">流程步骤</a><ul><li><a href="#打标签并更新发布版本" class="table-of-contents__link toc-highlight">打标签并更新发布版本</a></li><li><a href="#更新修改日志" class="table-of-contents__link toc-highlight">更新修改日志</a></li><li><a href="#运行发布工具" class="table-of-contents__link toc-highlight">运行发布工具</a></li><li><a href="#上传候选发布文件" class="table-of-contents__link toc-highlight">上传候选发布文件</a></li><li><a href="#开始投票流程" class="table-of-contents__link toc-highlight">开始投票流程</a></li><li><a href="#发布" class="table-of-contents__link toc-highlight">发布</a></li><li><a href="#验证发布" class="table-of-contents__link toc-highlight">验证发布</a></li></ul></li><li><a href="#为新发布更新网站" class="table-of-contents__link toc-highlight">为新发布更新网站</a><ul><li><a href="#更新文档版本" class="table-of-contents__link toc-highlight">更新文档版本</a></li><li><a href="#发布公告" class="table-of-contents__link toc-highlight">发布公告</a></li><li><a href="#更新下载页面" class="table-of-contents__link toc-highlight">更新下载页面</a></li></ul></li><li><a href="#签名您的第一个发布" class="table-of-contents__link toc-highlight">签名您的第一个发布</a><ul><li><a href="#生成密钥" class="table-of-contents__link toc-highlight">生成密钥</a></li><li><a href="#将签名添加到项目keys文件中" class="table-of-contents__link toc-highlight">将签名添加到项目KEYS文件中</a></li></ul></li></ul></div></div></div></main></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">博客</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cloudera.com/yunikorn-a-universal-resources-scheduler/" target="_blank" rel="noopener noreferrer" class="footer__link-item">What&#x27;s YuniKorn?<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.cloudera.com/spark-on-kubernetes-gang-scheduling-with-yunikorn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Spark on Kubernetes – Gang Scheduling with YuniKorn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">代码库</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/yunikorn-core/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Core scheduler<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-k8shim" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kubernetes shim<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-scheduler-interface" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scheduler Interface<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-web" target="_blank" rel="noopener noreferrer" class="footer__link-item">WEB application<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/apache/yunikorn-site" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/community/get_involved">参与</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-cn/community/community/people">人们</a></li><li class="footer__item"><a href="https://issues.apache.org/jira/projects/YUNIKORN/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
<div style="font-size: 70%">
Copyright © 2020-2023 <a href="https://www.apache.org/">The Apache Software Foundation</a>. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>. <br>
<div style="padding:20px; margin: 10px; color: #4d4d4d;">
<p>The Apache Software Foundation Apache YuniKorn, YuniKorn, Apache, the Apache feather, and the Apache YuniKorn project logo are either registered trademarks or trademarks of the Apache Software Foundation.</p>
</div>
</div></div></div></div></footer></div>
<script src="/zh-cn/assets/js/runtime~main.bdaf632d.js"></script>
<script src="/zh-cn/assets/js/main.f4f57a7e.js"></script>
</body>
</html>